<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ä½¿ç”¨PHPå®ç°Javaçš„RSAåŠ ç­¾æ–¹æ³• | Moxz Blog</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?c838626f612a22725168e1a92aaa438c";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    <meta name="description" content="
æœ€è¿‘æœ‰ä¸€ä¸ªä½¿ç”¨PHPå¼€å‘çš„æ¥å…¥æœºæ„ï¼ŒæŒ‰ç…§åŒäº‹ç»™å‡ºçš„Javaä»£ç å¦‚ä¸‹ï¼š
public static String sign(byte[] data, String privateKey) throws Exception {
    MessageDigest messageDigest = MessageDigest.getInstance("SHA-256");
    me ...">
    <meta name="baidu-site-verification" content="code-C8OyTS1FAY">
    
    <link rel="preload" href="/assets/css/0.styles.69e31e73.css" as="style"><link rel="preload" href="/assets/js/app.d2f1f4ee.js" as="script"><link rel="preload" href="/assets/js/6.86baad8d.js" as="script"><link rel="preload" href="/assets/js/12.d5b0440f.js" as="script"><link rel="preload" href="/assets/js/13.a19b6f49.js" as="script"><link rel="prefetch" href="/assets/js/10.5a75828b.js"><link rel="prefetch" href="/assets/js/11.e4e5bb84.js"><link rel="prefetch" href="/assets/js/14.bed357be.js"><link rel="prefetch" href="/assets/js/15.7a4e1b49.js"><link rel="prefetch" href="/assets/js/3.53b9d3bd.js"><link rel="prefetch" href="/assets/js/4.b0b7d7b9.js"><link rel="prefetch" href="/assets/js/5.eaea3094.js"><link rel="prefetch" href="/assets/js/7.b781aead.js"><link rel="prefetch" href="/assets/js/8.c8345aee.js"><link rel="prefetch" href="/assets/js/9.6f8bf260.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.a1ad9120.js">
    <link rel="stylesheet" href="/assets/css/0.styles.69e31e73.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">Moxz Blog </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/tag/" class="nav-link">Tags</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">Moxz Blog </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">Tags</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div><div class="content__default"><h2 id="èµ·å› "><a href="#èµ·å› " class="header-anchor">#</a> èµ·å› </h2> <p>æœ€è¿‘æœ‰ä¸€ä¸ªä½¿ç”¨PHPå¼€å‘çš„æ¥å…¥æœºæ„ï¼ŒæŒ‰ç…§åŒäº‹ç»™å‡ºçš„Javaä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">sign</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span> <span class="token class-name">String</span> privateKey<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">MessageDigest</span> messageDigest <span class="token operator">=</span> <span class="token class-name">MessageDigest</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;SHA-256&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    messageDigest<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hashData <span class="token operator">=</span> messageDigest<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> keyBytes <span class="token operator">=</span> <span class="token class-name">Base64Utils</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token class-name">PKCS8EncodedKeySpec</span> pkcs8KeySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PKCS8EncodedKeySpec</span><span class="token punctuation">(</span>keyBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;RSA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">PrivateKey</span> privateK <span class="token operator">=</span> keyFactory<span class="token punctuation">.</span><span class="token function">generatePrivate</span><span class="token punctuation">(</span>pkcs8KeySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Signature</span> signature <span class="token operator">=</span> <span class="token class-name">Signature</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;NONEWithRSA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    signature<span class="token punctuation">.</span><span class="token function">initSign</span><span class="token punctuation">(</span>privateK<span class="token punctuation">)</span><span class="token punctuation">;</span>
    signature<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>hashData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sign <span class="token operator">=</span> signature<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>sign<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å°†å…¶è½¬æ¢ä¸ºPHPä»£ç ï¼ŒåŠ ç­¾åï¼Œå‘ç°æˆ‘ä»¬çš„ç³»ç»ŸéªŒç­¾å¤±è´¥ã€‚</p> <h2 id="è¯•æ°´"><a href="#è¯•æ°´" class="header-anchor">#</a> è¯•æ°´</h2> <p>æœºæ„å‘é—®ï¼Œå½“æ—¶æ­£å€¼åä¸€ï¼Œåœ¨å®¶é™ªå¥³ç¥¨ï¼Œä¹Ÿæ²¡å’‹ç†ä»–ä»¬ï¼Œåæ¥å‘ç°ä»–ä»¬æ€¥å¾—ç«Ÿç„¶åœ¨stackoverflowä¸Šå‘é—®äº†...<a href="https://stackoverflow.com/questions/64245668/private-key-sign-data-in-java-to-php" target="_blank" rel="noopener noreferrer">é—®é¢˜é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œåä¸€å›æ¥æ²¡æƒ³åˆ°ä»–ä»¬è¿˜æ²¡æœ‰è§£å†³ï¼Œä¸€ç›´è¦æ±‚æˆ‘ä»¬æ”¹JavaéªŒç­¾ç®—æ³•ï¼Œè¯´PHPæ²¡æœ‰Javaå¯¹åº”çš„ç®—æ³•ã€‚æˆ‘ä¿¡ä½ ä¸ªé¬¼ï¼ŒPHPè¿™ä¹ˆå¼ºå¤§çš„è¯­è¨€æ€ä¹ˆå¯èƒ½è¿è¿™ç§åŸºæœ¬çš„ç®—æ³•éƒ½æ²¡æœ‰ã€‚</p> <p>é‚ç°å­¦äº†åŠå¤©PHPï¼Œå‘ç°PHPçš„openssl_sign()æ–¹æ³•</p> <div class="language- extra-class"><pre class="language-text"><code>openssl_sign ( string $data , string &amp;$signature , mixed $priv_key_id [, mixed $signature_alg = OPENSSL_ALGO_SHA1 ] ) : bool
</code></pre></div><p>ç¡®å®æ²¡æœ‰Javaçš„&quot;NONEWithRSA&quot;ï¼Œåªæœ‰ä¸€ä¸ªOPENSSL_ALGO_SHA256è·Ÿä¸Šé¢çš„Javaç®—æ³•æœ‰äº›ç±»ä¼¼ï¼Œå¸¦å…¥åˆ°PHPæ–¹æ³•ä¸­:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;123&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$privateKey</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAOyNIj7CYyrAzDELcBm/dSQD7rKSEY9k9btUcji/OxfJH+Je1C2Op51ORxrRUR09O2Oj/YKzkU+9ZG+1NqjdahBMHqJ/YCLJJ7noBtNBBgcyTmy13vDbL94mVw/lWC4jY7yQkeX5IcUKh62k2hVYPX+4VbdPYS9TTT+gceB3gLypAgMBAAECgYEAsbmL7CkyRpHaGFMmo0G0qh2GPoX+SYUqFtfohXgv1rwWh4aF1cCjcE26oIx5bAVwVHmGY6e0WnvKNR+qdI7+OtSRCz0Abr+3t1AO/RAmYHS6F6ZXBGlFMr2hNrl0YX0BsTTSAldyofCs6DaBa9XSThWDgAHh6C4qu3FegCp0KA0CQQD6StIrHYe+F1KjfjKQnQv19EAb3s7c9iBFa0hwMh40xdNaKLZtDEbY8jGpHkygIQ6cJFGl+xJr2Nx7B/oOTeCPAkEA8fIYM6HUOkkNjtE7oK+FIbrW9uUmjRwvQcaefXzPXgXbKW1yu7KeeotLaoYR7/GfTitOZMP+R+YiynCIBrG7RwJAD+z21nt4iaXeQjzjZsQ3YJz7/0n8C581inU7FLh7p4v22MPCZ8niMCeo9UPSSFYSIelFsLP7BhW0YbeuN37JDQJABr6sBAx34SQWN6wHkIQ0HuuZgIqE15w4iQnjczYehc19/ZqqfycMmff2I0MXjuvaeBBnABIirZhx0djvQdiEkwJBAJHxjIAys1pyQwKqCkizBlhZWl0G5+fdmEt0guspdJQ7V7JTdCf1SvbAiqIa/alwGs84PloYgOUeGEJb3HBNIfc=&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$priPem</span> <span class="token operator">=</span> <span class="token function">chunk_split</span><span class="token punctuation">(</span><span class="token variable">$privateKey</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$priPem</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;-----BEGIN PRIVATE KEY-----\n&quot;</span> <span class="token punctuation">.</span> <span class="token variable">$priPem</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">&quot;-----END PRIVATE KEY-----\n&quot;</span><span class="token punctuation">;</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$priPem</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$dataWithMD5</span> <span class="token operator">=</span> <span class="token function">md</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;sha256&quot;</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">openssl_get_privatekey</span><span class="token punctuation">(</span><span class="token variable">$priPem</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">openssl_sign</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$sign</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;sha256&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">openssl_free_key</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//base64ç¼–ç </span>
<span class="token variable">$sign</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$sign</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$sign</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p>å®ç°ä¹‹åå‘ç°å¾—åˆ°çš„ç­¾åç¡®å®æœ‰é—®é¢˜ã€‚</p> <h2 id="æ·±å…¥æ€è€ƒ"><a href="#æ·±å…¥æ€è€ƒ" class="header-anchor">#</a> æ·±å…¥æ€è€ƒ</h2> <p>éš¾é“æ˜¯æˆ‘é”™æ€ªæœºæ„äº†ï¼Ÿæˆ‘ä¸ä¿¡ğŸ˜’ï¼Œä»”ç»†çœ‹äº†ä¸€ä¸‹Javaçš„æ–¹æ³•ï¼Œå‘ç°Javaæ–¹æ³•æ˜¯å…ˆå°†å¾…åŠ ç­¾å­—ç¬¦ä¸²åšsha256æ‘˜è¦å¾—åˆ°ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œç„¶åå°†å…¶ä¼ å…¥åŠ ç­¾æ–¹æ³•ä¸­ï¼Œç›´æ¥ç§é’¥åŠ ç­¾ã€‚</p> <p>è€Œå¯¹æ¯”PHPæ–¹æ³•æ˜¯å°†å¾…ç­¾åå­—ç¬¦ä¸²ç›´æ¥åšäº†æ‘˜è¦ï¼Œç„¶åå°†æ‘˜è¦å­—ç¬¦ä¸²ä¼ å…¥åˆ°åŠ ç­¾æ–¹æ³•ä¸­åšsha256WithRsaï¼Œä¸Javaçš„ç­¾åå¤„ç†è¿‡ç¨‹æœ‰æ˜æ˜¾åŒºåˆ«ã€‚</p> <p>é¦–å…ˆï¼ŒPHPæ²¡æœ‰åŸç”Ÿçš„å­—èŠ‚æ•°ç»„è¿™ä¸ªæ¦‚å¿µï¼Œä½¿ç”¨hash()æ–¹æ³•åšæ‘˜è¦åå¾—åˆ°çš„ä¸ºè½¬æ¢ä¸ºASCIIç çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚</p> <p>å…¶æ¬¡ï¼Œopenssl_sign($data, $sign, $res, &quot;sha256&quot;)æ–¹æ³•æ˜¯å°†å­—ç¬¦ä¸²åœ¨åŠ ç­¾å‰åˆåšäº†ä¸€æ¬¡sha256.</p> <p>æ‰€ä»¥å¦‚æœæƒ³é€šè¿‡PHPå®ç°ä¸Šé¢Javaçš„åŠ ç­¾é€»è¾‘ï¼Œåˆ™å¤„ç†æµç¨‹åº”è¯¥ä¸ºï¼š</p> <p>ä»£ç­¾åå­—ç¬¦ä¸² --&gt; sha256æ‘˜è¦ --&gt;  é€šè¿‡ASCIIç å°†æ‘˜è¦å¾—åˆ°çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ­£å¸¸çš„ä½†ä¸å¯è¯»å­—ç¬¦ä¸²ï¼ˆç›¸å½“äºJavaçš„å­—èŠ‚æ•°ç»„ï¼‰ --&gt; ä½¿ç”¨ç§é’¥åŠ ç­¾ï¼Œåœ¨åŠ ç­¾æ—¶ä¸å†åšæ‘˜è¦ç®—æ³•</p> <h2 id="è¿åˆƒè€Œè§£"><a href="#è¿åˆƒè€Œè§£" class="header-anchor">#</a> è¿åˆƒè€Œè§£</h2> <p>è™½ç„¶openssl_sign()å¿…é¡»åšæ‘˜è¦ï¼Œä½†æ˜¯æ¢ä¸ªè§’åº¦æƒ³åŠ ç­¾å®é™…ä¸Šå°±æ˜¯é€šè¿‡ç§é’¥åŠ å¯†ï¼Œæ‰€ä»¥ä½¿ç”¨PHPçš„openssl_private_encrypt()æ–¹æ³•å°±å¯ä»¥å’¯ï¼Œäºæ˜¯å°±å¾—åˆ°äº†ä¸‹é¢çš„å®ç°æ–¹æ³•ï¼š</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;123&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$privateKey</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDpvXOAIa8Vma84CMQQMGxbAOt+CGh4GSL2xDyEW/Dh81EmPW1/fvNqG/QNPrxhKV3NRcO8xVv8Boq+lYoEONFP4bNVnvbbM+odQlFc8e+zgJM55nWgcPcOCsNrDhDI/SZrvtxLnulJGMH+xNHSz5/SHpESSWxlGKsBp87V6pqK87rKCoCK37+VDEisXDWqRl6M8chB9zaDWuiG7uAkpREn9NU+z3Y3/gzVCLd/gP3ytbkP00tjhG979U/XQaoQAJJ6kfyY3Qc4bLMh37JYiclzgur7752ENodV5mWZuUYrpNRy9lhzlOow5J2b+bIlbhQO3TJk3wCQHinxiykEVEcRAgMBAAECggEATSpiazazmqn2EsWyFLYnz5NqK12TP7LsvBLk971ytOWjMMCu2ZyLt8gqtgS0JE+HzDDwAe4WBAoU2/56ZhJr57dXgTjNvmhRLf+q5MhqnhQghsjypFkm9tfO1BT8rZ4FhSSpjb2UvrERuo43xyUMWk4FDsh2pJmUOyOvQSgGhUB4LqazpTS/5M9pduNZwHPql1yRSYd/3qfucguFNJdoCxbtLIxwDK0KSJlnKp7FbCO3WFaSV7yqrPb6M36Tkf/Sqsry9NUt4Lv85MLPH89nMhBA1BylAM2okHRlZSloHXDL6qJA3vDy7coCnT2p8MuFAHjSyxlUY4jeQRIBGVqC0QKBgQD320sW07O4giRY1i334Y31uVCLQz9KCTkreSPjc2kT4sIruOmQqSPxTCBdnx2To9A6dO1LBrH6bVmnNRVswlC69pphq5zVj7bk//HDUBwPCRdXGDUDgUVrx1cBFXAn/j+1ZuyyIYZAeipIwpb0YPFXOyXnQOT9Yyv9Xy806RWrEwKBgQDxa2ybsg5K1HDIt1AS3AK6AO7ljezeKIot9NPYrIqkT3r6ITYQbKr7DEuaDcDje2tMY4x4sRQe5lv24rg/kYQOGgbfITdDnwh4CHhe+zGuF8qIJdRVy0CCPBo7jyNVqPWBKnG7IYYlNXZpBR0tk2Pqi+WjB9CPBWlru3wQXoDFywKBgQDU2d1FUC7h/9lo9R3q5ye7YxaZUfnTAdK308OPO/h8HFs1ownpsmdsfDy7Sb7joGVdHjb+HFTRxACfCIZKrSEZPlfcEr2P5Whihq4/VdeSzfLeV6qHRQeyBDFie9+iaMSbazVP0FxzmLYhYAK1AV+g0um9C8zbEcSgRZLLtHNoQwKBgQDDoJsHp0cxl+g0nWbDgYisFOmBFnqkoxEloEiyQU6vSsCKQ7M9p/D9Mb9pfE+bhn0yD1Da1BNL3rsS2jEXQeFSVADRemb/4rTIH4T64m4ldp3lqVHgm60QW4eeT6UAWsNmAXDbhJThPetPupckQVUr0GUqsMBtxKLia7Biy1Fp9QKBgQCIlwoViSLY6VfkNZIgA+HoDcQfCdBSqWbqkRorKWjYHHWqNocMHUDsqtEgRx9QZUhd9lfVTPCsC3ff7k0IOhFr+G7czixUxJxrGXPVY8dMug4geU8h8CpAGyRjGpkAgWgckEc3uegSuAjm7H66TUWU1gTvAd4poI5gN+5FKi27eA==&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$priPem</span> <span class="token operator">=</span> <span class="token function">chunk_split</span><span class="token punctuation">(</span><span class="token variable">$privateKey</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$priPem</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;-----BEGIN PRIVATE KEY-----\n&quot;</span> <span class="token punctuation">.</span> <span class="token variable">$priPem</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">&quot;-----END PRIVATE KEY-----\n&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">openssl_get_privatekey</span><span class="token punctuation">(</span><span class="token variable">$priPem</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// sha256æ‘˜è¦</span>
<span class="token variable">$dataWithSha256</span> <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;sha256&quot;</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// é€šè¿‡ASCIIç å°†æ‘˜è¦å¾—åˆ°çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ­£å¸¸çš„ä½†ä¸å¯è¯»å­—ç¬¦ä¸²ï¼ˆç›¸å½“äºJavaçš„å­—èŠ‚æ•°ç»„ï¼‰</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$dataWithSha256</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">+</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token variable">$str</span><span class="token punctuation">.</span><span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token function">hexdec</span><span class="token punctuation">(</span><span class="token variable">$dataWithSha256</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token variable">$dataWithSha256</span><span class="token punctuation">[</span><span class="token variable">$i</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$dataWithSha256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ä½¿ç”¨ç§é’¥åŠ ç­¾ï¼Œåœ¨åŠ ç­¾æ—¶ä¸å†åšæ‘˜è¦ç®—æ³•</span>
<span class="token function">openssl_private_encrypt</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token variable">$sign</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">openssl_free_key</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//base64ç¼–ç </span>
<span class="token variable">$sign</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$sign</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$sign</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p>å‘ç°PHPå¾—åˆ°çš„ç­¾åä¸Javaä¸€è‡´ï¼Œå¤§åŠŸå‘Šæˆï¼å»æ‰“æœºæ„è„¸å–½âœŒ</p> <h2 id="åè®°"><a href="#åè®°" class="header-anchor">#</a> åè®°</h2> <ol><li>PHPæœç„¶ä¸æ„§æ’åå¤©ä¸‹ç¬¬ä¸€çš„è¯­è¨€ğŸ˜ï¼Œæ—¢ç®€å•åˆå®ç”¨ï¼›</li> <li>ç¨‹åºçŒ¿çš„å¿«ä¹æºæ³‰å°±æ˜¯è§£å†³åˆ«äººè§£å†³ä¸äº†çš„é—®é¢˜ï¼›</li> <li>è¯­è¨€æ°¸è¿œä¸æ˜¯å®ç°åŠŸèƒ½çš„å£å’ã€‚</li> <li>æœ¬æ–‡ç€é‡è®°å½•äº†å½“æ—¶çš„è§£å†³é—®é¢˜çš„å¿ƒè·¯å†ç¨‹ï¼Œå¸Œæœ›ç»™å¤§å®¶å¸¦æ¥æ”¶è·ã€‚</li></ol></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8><li class="copyright-item" data-v-3d9deeb8><a href="https://policies.google.com/privacy?hl=en-US" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8>Privacy Policy</a></li><li class="copyright-item" data-v-3d9deeb8>MIT Licensed | Copyright Â© 2019-present Moxz</li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d2f1f4ee.js" defer></script><script src="/assets/js/6.86baad8d.js" defer></script><script src="/assets/js/12.d5b0440f.js" defer></script><script src="/assets/js/13.a19b6f49.js" defer></script>
  </body>
</html>
